@using TGenWebApp.Services
@using TGenWebApp.Shared.NavMenus
@inject Blazored.LocalStorage.ILocalStorageService LocalStorage
@inject NavigationManager Manager;

@if (_isLoggedIn) {
    @if (_isInstitute) {
        <InstitutionLoginNavMenu Session="@_session" OnSessionChanged="@SessionChanged"/>
    } else {
        <UserLoginNavMenu Session="@_session" OnSessionChanged="@SessionChanged"/>
    }
} else {
    <LoggedOutNavMenu OnSessionChanged="@SessionChanged"/>
}

@code {

    private Session _session;
    private bool _isLoggedIn, _isInstitute;

    private void SessionChanged(Session newSession) {
        if (newSession is null) {
            _isLoggedIn = false;
            _isInstitute = false;
            _session = null;
            return;
        }
        _session = newSession;
        if (string.IsNullOrEmpty(_session?.Id)) return;
        _isLoggedIn = true;
        _isInstitute = (_session.userType == UserType.institution);
    }

}